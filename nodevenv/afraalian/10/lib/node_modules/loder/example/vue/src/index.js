import loder from 'loder'
import * as Loading from './loading'

Loading.show()

// 注册资源 —— 应用创建函数
loder('createAppFn', () => import('./createApp').then(res => res.default))
// 注册资源 —— 请求客户端
loder('axios', () => import('axios').then(res => res.default))

// 注册资源 —— 首屏数据
loder('data', ['axios'], () => {
  const axios = loder.get('axios')
  return axios('https://jsonplaceholder.typicode.com/posts')
})

// 注册任务 —— 启动应用
loder('bootstrap', ['createAppFn', 'data'], () => {
  const create = loder.get('createAppFn')
  setTimeout(() => {
    create()
    Loading.hide()
  }, 1000)
})

// 运行启动应用任务
loder.run('bootstrap')
